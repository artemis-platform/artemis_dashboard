<%=
  headings = Enum.map(@columns, fn (column) ->
    render_data_table_label(get_conn_or_socket(assigns), column, :csv)
  end)

  rows = Enum.map(@data, fn (row) -> 
    Enum.map(@columns, fn (column) ->
      render_data_table_value(get_conn_or_socket(assigns), column, row, :csv)
    end)
  end)

  ArtemisWeb.CSV.create([headings|rows])
%>
